<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ä»Šå¤©åƒä»€ä¹ˆ</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background-color: #f9f9f9;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      overflow: hidden;
      position: relative;
    }

    .container {
      text-align: center;
      background: #fff;
      padding: 40px;
      border-radius: 15px;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
      position: relative;
      z-index: 2;
    }

    h1 {
      color: #333;
      margin-bottom: 20px;
    }

    button {
      background-color: #ff6f61;
      color: white;
      border: none;
      padding: 15px 30px;
      font-size: 18px;
      border-radius: 10px;
      cursor: pointer;
      transition: transform 0.2s ease-in-out, background-color 0.2s ease-in-out;
      margin: 5px;
    }

    button:hover {
      background-color: #e65c50;
      transform: scale(1.05);
    }

    .result {
      margin-top: 30px;
      font-size: 20px;
      color: #555;
      min-height: 30px;
      position: relative;
    }

    /* é”®å¸½çˆ†ç‚¸åŠ¨ç”» */
    .keycap-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
      overflow: hidden;
    }

    .keycap {
      font-size: 30px; /* è®¾ç½®è¡¨æƒ…ç¬¦å·å¤§å° */
      color: #8b5a2b; /* è®¾ç½®â€œğŸ’©â€çš„é¢œè‰² */
      position: absolute;
      animation: explode 1.2s ease-in-out forwards;
    }

    @keyframes explode {
      0% {
        transform: scale(1) translate(0, 0) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: scale(0.7) translate(var(--x), var(--y)) rotate(var(--rotate));
        opacity: 0;
      }
    }

    /* æŸ¥çœ‹æ¨èè®°å½•æŒ‰é’® */
    .history-button {
      position: absolute;
      top: 20px;
      right: 20px;
      background-color: #aaa;
      color: white;
      border: none;
      padding: 8px 12px;
      font-size: 14px;
      border-radius: 5px;
      cursor: pointer;
      transition: transform 0.2s ease-in-out, background-color 0.2s ease-in-out;
      z-index: 3;
    }

    .history-button:hover {
      background-color: #888;
      transform: scale(1.05);
    }

    .history-list {
      margin-top: 20px;
      max-height: 150px;
      overflow-y: auto;
      border: 1px solid #ddd;
      padding: 10px;
      border-radius: 5px;
      display: none;
    }

    .history-item {
      font-size: 14px;
      color: #555;
      margin: 5px 0;
    }

    .history-time {
      font-size: 12px;
      color: #888;
      margin-left: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ä»Šå¤©åƒä»€ä¹ˆ</h1>
    <button id="chooseButton">ä¸ºæˆ‘æ¨è</button>
    <div class="result" id="result"></div>
    <div class="history-list" id="historyList"></div>
  </div>

  <!-- æŸ¥çœ‹æ¨èè®°å½•æŒ‰é’® -->
  <button id="historyButton" class="history-button">æŸ¥çœ‹è®°å½•</button>

  <!-- é”®å¸½çˆ†ç‚¸å®¹å™¨ -->
  <div class="keycap-container" id="keycapContainer"></div>

  <script>
    // å®šä¹‰é€‰é¡¹åŠå¯¹åº”çš„æ¦‚ç‡
    const items = [
      { name: "ğŸ’©", probability: 0.1 },
      { name: "ğŸ«å‘³çš„ğŸ’©", probability: 0.1 },
      { name: "ğŸ’©å‘³çš„ğŸ«", probability: 0.1 },
      { name: "ğŸ’©å‘³çš„ğŸš¬", probability: 0.1 },
      { name: "ç²˜åˆ°ğŸ’©çš„ğŸš¬", probability: 0.1 },
      { name: "ç²˜åˆ°ğŸ’©çš„ğŸŸ", probability: 0.1 },
      { name: "ç²˜åˆ°ğŸ’©çš„ğŸœ", probability: 0.1 },
      { name: "ç²˜åˆ°ğŸ’©çš„ğŸ£", probability: 0.1 },
      { name: "ğŸª³", probability: 0.1 },
      { name: "ğŸš¬", probability: 0.02 },
      { name: "ğŸ«", probability: 0.02 },
      { name: "ğŸŸ", probability: 0.02 },
      { name: "ğŸœ", probability: 0.02 },
      { name: "ğŸ£", probability: 0.02 }
    ];

    // æ ¹æ®æ¦‚ç‡éšæœºé€‰æ‹©ä¸€ä¸ªé€‰é¡¹
    function getRandomItem() {
      const random = Math.random(); // ç”Ÿæˆ 0 åˆ° 1 çš„éšæœºæ•°
      let cumulativeProbability = 0;

      for (const item of items) {
        cumulativeProbability += item.probability;
        if (random < cumulativeProbability) {
          return item.name;
        }
      }
      return items[items.length - 1].name; // ç¡®ä¿è¿”å›æœ€åä¸€ä¸ªé€‰é¡¹ï¼ˆç†è®ºä¸Šä¸ä¼šè§¦å‘ï¼‰
    }

    const chooseButton = document.getElementById("chooseButton");
    const resultDiv = document.getElementById("result");
    const keycapContainer = document.getElementById("keycapContainer");
    const historyButton = document.getElementById("historyButton");
    const historyList = document.getElementById("historyList");

    let recommendationHistory = [];

    // åˆ›å»ºé”®å¸½çˆ†ç‚¸åŠ¨ç”»
    function createKeycapExplosion() {
      keycapContainer.innerHTML = ""; // æ¸…ç©ºä¹‹å‰çš„é”®å¸½
      for (let i = 0; i < 50; i++) { // å¢åŠ é”®å¸½æ•°é‡
        const keycap = document.createElement("div");
        keycap.classList.add("keycap");
        keycap.textContent = "ğŸ’©"; // ä½¿ç”¨â€œğŸ’©â€ä½œä¸ºé”®å¸½å†…å®¹
        const angle = Math.random() * 2 * Math.PI; // éšæœºè§’åº¦
        const distance = Math.random() * window.innerWidth / 1.5; // æ‰©å¤§æ‰©æ•£èŒƒå›´
        const x = Math.cos(angle) * distance; // è®¡ç®—Xåç§»
        const y = Math.sin(angle) * distance; // è®¡ç®—Yåç§»
        const rotate = Math.random() * 720 - 360; // éšæœºæ—‹è½¬è§’åº¦ï¼ˆ-360åˆ°360åº¦ï¼‰
        keycap.style.setProperty("--x", `${x}px`);
        keycap.style.setProperty("--y", `${y}px`);
        keycap.style.setProperty("--rotate", `${rotate}deg`);
        keycap.style.left = `${window.innerWidth / 2}px`; // åˆå§‹ä½ç½®åœ¨å±å¹•ä¸­å¿ƒ
        keycap.style.top = `${window.innerHeight / 2}px`;
        keycap.style.animationDelay = `${Math.random() * 0.3}s`; // éšæœºåŠ¨ç”»å»¶è¿Ÿ
        keycapContainer.appendChild(keycap);
      }
    }

    // ç‚¹å‡»æ¨èæŒ‰é’®
    chooseButton.addEventListener("click", () => {
      // å¼€å§‹æ»šåŠ¨åŠ¨ç”»
      let currentIndex = 0;
      const totalRolls = 30; // æ»šåŠ¨æ¬¡æ•°ï¼ˆæ§åˆ¶é€Ÿåº¦å’ŒæŒç»­æ—¶é—´ï¼‰
      const intervalTime = 50; // æ¯æ¬¡æ»šåŠ¨çš„æ—¶é—´é—´éš”

      const rollInterval = setInterval(() => {
        currentIndex = (currentIndex + 1) % items.length;
        resultDiv.textContent = items[currentIndex].name;
      }, intervalTime);

      // åœæ­¢æ»šåŠ¨å¹¶æ˜¾ç¤ºæœ€ç»ˆç»“æœ
      setTimeout(() => {
        clearInterval(rollInterval); // åœæ­¢æ»šåŠ¨
        const selectedItem = getRandomItem();
        resultDiv.textContent = `æ¨èä½ åƒï¼š${selectedItem}`; // æ˜¾ç¤ºæœ€ç»ˆç»“æœ

        // æ·»åŠ åˆ°æ¨èè®°å½•ï¼Œé™„å¸¦å½“å‰æ—¶é—´
        const currentTime = new Date().toLocaleString(); // è·å–å½“å‰æ—¶é—´
        recommendationHistory.push({ item: selectedItem, time: currentTime });

        // é”®å¸½çˆ†ç‚¸åŠ¨ç”»
        createKeycapExplosion();
      }, totalRolls * intervalTime);
    });

    // æŸ¥çœ‹æ¨èè®°å½•
    historyButton.addEventListener("click", () => {
      if (historyList.style.display === "block") {
        historyList.style.display = "none";
      } else {
        historyList.innerHTML = ""; // æ¸…ç©ºå†å²è®°å½•åˆ—è¡¨
        recommendationHistory.forEach((record, index) => {
          const historyItem = document.createElement("div");
          historyItem.classList.add("history-item");
          historyItem.textContent = `${index + 1}. ${record.item}`;
          
          // æ·»åŠ æ—¶é—´æˆ³
          const historyTime = document.createElement("span");
          historyTime.classList.add("history-time");
          historyTime.textContent = record.time;
          historyItem.appendChild(historyTime);
          
          historyList.appendChild(historyItem);
        });
        historyList.style.display = "block";
      }
    });
  </script>
</body>
</html>